多级缓存主要是为了解决高并发tomcat的并发能力不足（tomcat限制了Redis等的并发能力）

**多级缓存方案：**多级缓存就是充分利用请求处理的每个环节，分别添加缓存，减轻tomcat压力，提升性能

例如：客户端发送请求会先经过nginx，如果访问过该数据，则浏览器客户端会有缓存。下一次发送请求时，nginx检查数据是否有变化，没有则返回304状态码。客户端收到状态就会知道本地已经存在缓存。从来不会去查找数据库或者Redis。

**多级缓存结构（大部分缓存有nginx处理而不会经过tomcat，性能大幅度提升）：**

第一级缓存：浏览器客户端缓存

第二级缓存：nginx本地缓存

第三级缓存：Redis缓存（因为有nginx，不会再去经过tomcat，性能提升）

第四级缓存：tomcat缓存（tomcat存在进程缓存在tomcat本地，如果进程缓存未命中，才访问数据库）

第五级缓存：数据库缓存

**这样的结构nginx压力会非常大，因此nginx会部署为一个集群。然后单独部署一个nginx做反向代理（该nginx在nginx集群前面，nginx相当于一个web服务器了）**



#### 多级缓存实现：

* JVM进程缓存
* Lua语法入门
* 实现多级缓存
* 缓存同步策略



### 一、JVM进程缓存

**本地进程缓存**

* **分布式缓存（例如Redis）：**
  * **优点：**存储容量更大、可靠性更好、可以在集群中共享
  * **缺点：**访问缓存有网络开销
  * **场景：**缓存数据量较大、可靠性要求较高、需要再集群间共享
* **进程本地缓存（例如HashMap、GuavaCache）：**
  * **优点：**读取本地内存，没有网络开销，速度更快
  * **缺点：**存储容量有限、可靠性较低、无法共享
  * **场景：**性能要求较高，缓存数据量较小



